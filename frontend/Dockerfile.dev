# Development Dockerfile for frontend with hot reloading
FROM node:18-alpine

WORKDIR /app

# Install dependencies
COPY package*.json ./
RUN npm install

# Copy the rest of the application
COPY . .

# Expose dev server port
EXPOSE 80

# Start Vite in development mode with host set to 0.0.0.0 and explicitly disable open
ENV BROWSER=none
ENV FORCE_COLOR=1

# Set entry point to prevent container exit on error
ENTRYPOINT ["sh", "-c"]

# Prevent auto-opening browser and restart on failures
CMD ["npm run dev -- --host 0.0.0.0 --port 80 --no-open || (sleep 2 && npm run dev -- --host 0.0.0.0 --port 80 --no-open)"]
